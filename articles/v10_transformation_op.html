<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="starschemar">
<title>starschemar Transformation Operations • starschemar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="starschemar Transformation Operations">
<meta property="og:description" content="starschemar">
<meta property="og:image" content="https://josesamos.github.io/starschemar/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">starschemar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.4.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/starschemar.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/v10_transformation_op.html">starschemar Transformation Operations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/josesamos/starschemar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>starschemar Transformation Operations</h1>
                        <h4 data-toc-skip class="author">Jose Samos (<a href="mailto:jsamos@ugr.es" class="email">jsamos@ugr.es</a>)</h4>
            
            <h4 data-toc-skip class="date">2020-09-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/josesamos/starschemar/blob/HEAD/vignettes/v10_transformation_op.Rmd" class="external-link"><code>vignettes/v10_transformation_op.Rmd</code></a></small>
      <div class="d-none name"><code>v10_transformation_op.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Package <code>starschemar</code> offers operations to transform flat
tables into star schemas and also to export or exploit them through
queries.</p>
<ol style="list-style-type: decimal">
<li><p>From a flat table, we define a dimensional model classifying its
attributes as facts or dimensions (<em>dimensional
modelling</em>).</p></li>
<li><p>From a flat table and a dimensional model we obtain a star schema
that we can transform; from various star schemas we can define a
constellation (<em>star schema and constellation
definition</em>).</p></li>
<li><p>Dimensions contain rows without duplicates, we can apply
operations to perform data cleaning and to conform them (<em>cleaning
and conforming data</em>).</p></li>
<li><p>When new data is obtained, it is necessary to refresh the
existing data with them by means of incremental refresh operations
(<em>incremental refresh</em>).</p></li>
<li><p>The results obtained can be exported to be consulted with other
tools (<em>exporting results</em>).</p></li>
<li><p>Finally, basic queries can be performed from R (<em>query
functions</em>), especially to select the data to export.</p></li>
</ol>
<p>In this document, these operations available in the package are
briefly presented.</p>
</div>
<div class="section level2">
<h2 id="dimensional-modelling">Dimensional modelling<a class="anchor" aria-label="anchor" href="#dimensional-modelling"></a>
</h2>
<p>Starting from a flat table, a dimensional model is defined specifying
the attributes that make up each of the dimensions and the measurements
in the facts. The result is a <code>dimensional_model</code> object. It
is carried out through the following functions:</p>
<ul>
<li>
<code><a href="../reference/dimensional_model.html">dimensional_model()</a></code>: An empty
<code>dimensional_model</code> object is created in which definition of
facts and dimensions can be added. Example:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_model.html">dimensional_model</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/define_dimension.html">define_dimension()</a></code>: To define a dimension in a
<code>dimensional_model</code> object, we have to define its name and
the set of attributes that make it up. Example:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_model.html">dimensional_model</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/define_dimension.html">define_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"When"</span>,</span>
<span>                   attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Week Ending Date"</span>,</span>
<span>                                  <span class="st">"WEEK"</span>,</span>
<span>                                  <span class="st">"Year"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/define_fact.html">define_fact()</a></code>: To define facts in a
<code>dimensional_model</code> object, the essential data is a name and
a set of measurements that can be empty (does not have explicit
measurements). Associated with each measurement, an aggregation function
is required, which by default is SUM. Examples:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_model.html">dimensional_model</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/define_fact.html">define_fact</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"mrs_age"</span>,</span>
<span>    measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Deaths"</span><span class="op">)</span>,</span>
<span>    agg_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SUM"</span><span class="op">)</span>,</span>
<span>    nrow_agg <span class="op">=</span> <span class="st">"nrow_agg"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_model.html">dimensional_model</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/define_fact.html">define_fact</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Factless fact"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="star-schema-and-constellation-definition">Star schema and constellation definition<a class="anchor" aria-label="anchor" href="#star-schema-and-constellation-definition"></a>
</h2>
<p>A dimensional model is implemented using a star schema. We can have
several related star schemas through common dimensions that together
form a fact constellation.</p>
<div class="section level3">
<h3 id="star-schema-definition">Star schema definition<a class="anchor" aria-label="anchor" href="#star-schema-definition"></a>
</h3>
<p>A star schema is defined from a flat table and a dimensional model
definition. Once defined, a star schema can be transformed by defining
role playing dimensions, changing the writing style of element names or
the type of dimension attributes. These operations are carried out
through the following functions:</p>
<ul>
<li>
<code><a href="../reference/star_schema.html">star_schema()</a></code>: Creates a <code>star_schema</code>
object from a flat table (implemented by a <code>tibble</code>) and a
<code>dimensional_model</code> object. Example:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/star_schema.html">star_schema</a></span><span class="op">(</span><span class="va">mrs_age</span>, <span class="va">dm_mrs_age</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/role_playing_dimension.html">role_playing_dimension()</a></code>: Given a list of
<code>star_schema</code> dimension names, all with the same structure, a
role playing dimension with the indicated name and attributes is
generated. The original dimensions become role dimensions defined from
the new role playing dimension. Example:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/star_schema.html">star_schema</a></span><span class="op">(</span><span class="va">mrs_age</span>, <span class="va">dm_mrs_age</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/role_playing_dimension.html">role_playing_dimension</a></span><span class="op">(</span></span>
<span>    dim_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"when"</span>, <span class="st">"when_available"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"When Common"</span>,</span>
<span>    attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>, <span class="st">"Week"</span>, <span class="st">"Year"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/snake_case.html">snake_case()</a></code>: Transform fact, dimension, measurement,
and attribute names according to the snake case style. Example:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/star_schema.html">star_schema</a></span><span class="op">(</span><span class="va">mrs_age</span>, <span class="va">dm_mrs_age</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/snake_case.html">snake_case</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/character_dimensions.html">character_dimensions()</a></code>: Transforms numeric type
attributes of dimensions into character type. In a
<code>star_schema</code> numerical data are measurements that are
situated in the facts. Numerical data in dimensions are usually codes,
day, week, month or year numbers. There are tools that consider any
numerical data to be a measurement, for this reason it is appropriate to
transform the numerical data of dimensions into character data. It also
allows indicating the literal to be used in case the numerical value is
not defined. Example:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/star_schema.html">star_schema</a></span><span class="op">(</span><span class="va">mrs_age</span>, <span class="va">dm_mrs_age</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/character_dimensions.html">character_dimensions</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="star-schema-rename">Star schema rename<a class="anchor" aria-label="anchor" href="#star-schema-rename"></a>
</h3>
<p>Once a star schema is defined, we can rename its elements. It is
necessary to be able to rename attributes of dimensions and measures of
facts because the definition operations only allowed us to select
columns of a flat table. For completeness also dimensions and facts can
be renamed. To carry out these operations, the following functions are
available:</p>
<ul>
<li>
<code><a href="../reference/rename_dimension.html">rename_dimension()</a></code>: Set new name for a dimension.
Example:</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/rename_dimension.html">rename_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"when"</span>, new_name <span class="op">=</span> <span class="st">"when_happened"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/get_dimension_attribute_names.html">get_dimension_attribute_names()</a></code>: Get the name of
attributes in a dimension, so that it is easier to modify them if
necessary. Example:</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">attribute_names</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">st_mrs_age</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_dimension_attribute_names.html">get_dimension_attribute_names</a></span><span class="op">(</span><span class="st">"when"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/rename_dimension_attributes.html">rename_dimension_attributes()</a></code>: Set new names of some
attributes in a dimension. Example:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">st_mrs_age</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/rename_dimension_attributes.html">rename_dimension_attributes</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"when"</span>,</span>
<span>    attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"when_happened_week"</span>, <span class="st">"when_happened_year"</span><span class="op">)</span>,</span>
<span>    new_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"week"</span>, <span class="st">"year"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/rename_fact.html">rename_fact()</a></code>: Set new name for facts. Example:</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/rename_fact.html">rename_fact</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span> </span></code></pre></div>
<ul>
<li>
<code><a href="../reference/get_measure_names.html">get_measure_names()</a></code>: Get the name of the measures in
fact, so that it is easier to modify them if necessary. Example:</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">measure_names</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">st_mrs_age</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/get_measure_names.html">get_measure_names</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/rename_measures.html">rename_measures()</a></code>: Set new names of some measures in
facts. Example:</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">st_mrs_age</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/rename_measures.html">rename_measures</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_deaths"</span><span class="op">)</span>,</span>
<span>                                 new_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"num_deaths"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="constellation-definition">Constellation definition<a class="anchor" aria-label="anchor" href="#constellation-definition"></a>
</h3>
<p>Based on various star schemas, a constellation can be defined in
which star schemas share common dimensions. Dimensions with the same
name must be shared. It is defined by the following function:</p>
<ul>
<li>
<code><a href="../reference/constellation.html">constellation()</a></code>: Creates a <code>constellation</code>
object from a list of <code>star_schema</code> objects. All dimensions
with the same name in the star schemas have to be conformable.
Example:</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/constellation.html">constellation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">st_mrs_age</span>, <span class="va">st_mrs_cause</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"mrs"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="cleaning-and-conforming-data">Cleaning and conforming data<a class="anchor" aria-label="anchor" href="#cleaning-and-conforming-data"></a>
</h2>
<p>Once star schemas and fact constellations are defined, data cleaning
operations can be carried out on dimensions. There are three groups of
functions:</p>
<ol style="list-style-type: decimal">
<li><p>One to obtain components of star schemas and
constellations.</p></li>
<li><p>Another to define data cleaning operations over
dimensions.</p></li>
<li><p>One more to apply operations to star schemas or
constellations.</p></li>
</ol>
<div class="section level3">
<h3 id="obtaining-components">Obtaining components<a class="anchor" aria-label="anchor" href="#obtaining-components"></a>
</h3>
<p>We can obtain dimensions from a star schema or conformed dimensions
from a fact constellation. Available functions in both cases are
similar.</p>
<div class="section level4">
<h4 id="star-schema">Star schema<a class="anchor" aria-label="anchor" href="#star-schema"></a>
</h4>
<ul>
<li>
<code><a href="../reference/get_dimension_names.html">get_dimension_names()</a></code>: Get the names of the dimensions
of a star schema. Role playing dimensions are not considered.
Example:</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dn</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_dimension_names.html">get_dimension_names</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/get_dimension.html">get_dimension()</a></code>: Get a dimension of a star schema given
its name. Role dimensions can be obtained but not role playing
dimensions. Example:</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">where</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_dimension.html">get_dimension</a></span><span class="op">(</span><span class="st">"where"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="constellation">Constellation<a class="anchor" aria-label="anchor" href="#constellation"></a>
</h4>
<ul>
<li>
<code><a href="../reference/get_conformed_dimension_names.html">get_conformed_dimension_names()</a></code>: Get the names of the
conformed dimensions of a constellation. Example:</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dn</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_conformed_dimension_names.html">get_conformed_dimension_names</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/get_conformed_dimension.html">get_conformed_dimension()</a></code>: Get a conformed dimension of
a constellation given its name. Example:</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">when</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_conformed_dimension.html">get_conformed_dimension</a></span><span class="op">(</span><span class="st">"when"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/get_star_schema_names.html">get_star_schema_names()</a></code>: Get the names of the star
schemas of a constellation. Example:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stn</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_star_schema_names.html">get_star_schema_names</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/get_star_schema.html">get_star_schema()</a></code>: Get a star schema of a constellation
given its name. Example:</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_star_schema.html">get_star_schema</a></span><span class="op">(</span><span class="st">"mrs_age"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="definition-of-updates">Definition of updates<a class="anchor" aria-label="anchor" href="#definition-of-updates"></a>
</h3>
<p>Modifications are defined on dimension rows in various ways based
exclusively on the values of the dimension fields. Although the
surrogate key intervenes in the definition, the result, internally, does
not depend on it so that it can be applied more generally in other star
schemas.</p>
<ul>
<li>
<code><a href="../reference/record_update_set.html">record_update_set()</a></code>: A <code>record_update_set</code>
object is created. Stores updates on dimension records. Each update is
made up of a dimension name, an old value set, and a new value set.
Example:</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/record_update_set.html">record_update_set</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/match_records.html">match_records()</a></code>: For a dimension, given the primary key
of two records, it adds an update to the set of updates that modifies
the combination of values of the rest of attributes of the first record
so that they become the same as those of the second. Example:</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/record_update_set.html">record_update_set</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/match_records.html">match_records</a></span><span class="op">(</span>dimension <span class="op">=</span> <span class="va">where</span>,</span>
<span>                old <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                new <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/update_record.html">update_record()</a></code>: For a dimension, given the primary key
of one record, it adds an update to the set of updates that modifies the
combination of values of the rest of attributes of the selected record
so that they become those given. Example:</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/record_update_set.html">record_update_set</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/update_record.html">update_record</a></span><span class="op">(</span></span>
<span>    dimension <span class="op">=</span> <span class="va">who</span>,</span>
<span>    old <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1: &lt;1 year"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/update_selection.html">update_selection()</a></code>: For a dimension, given a vector of
column names, a vector of old values and a vector of new values, it adds
an update to the set of updates that modifies all the records that have
the combination of old values in the columns with the new values in
those same columns. Example:</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/record_update_set.html">record_update_set</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/update_selection.html">update_selection</a></span><span class="op">(</span></span>
<span>    dimension <span class="op">=</span> <span class="va">where</span>,</span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"city"</span><span class="op">)</span>,</span>
<span>    old_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bridgepor"</span><span class="op">)</span>,</span>
<span>    new_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bridgeport"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/update_selection_general.html">update_selection_general()</a></code>: For a dimension, given a
vector of column names, a vector of old values for those columns,
another vector column names, and a vector of new values for those
columns, it adds an update to the set of updates that modifies all the
records that have the combination of old values in the first column
vector with the new values in the second column vector. Example:</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/record_update_set.html">record_update_set</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/update_selection_general.html">update_selection_general</a></span><span class="op">(</span></span>
<span>    dimension <span class="op">=</span> <span class="va">where</span>,</span>
<span>    columns_old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>, <span class="st">"city"</span><span class="op">)</span>,</span>
<span>    old_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CT"</span>, <span class="st">"Bridgepor"</span><span class="op">)</span>,</span>
<span>    columns_new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"city"</span><span class="op">)</span>,</span>
<span>    new_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bridgeport"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="updates-application">Updates application<a class="anchor" aria-label="anchor" href="#updates-application"></a>
</h3>
<p>Defined updates can be applied on a star schema or on the conformed
dimension of a fact constellation.</p>
<div class="section level4">
<h4 id="star-schema-1">Star schema<a class="anchor" aria-label="anchor" href="#star-schema-1"></a>
</h4>
<ul>
<li>
<code><a href="../reference/modify_dimension_records.html">modify_dimension_records()</a></code>: Given a list of dimension
record update operations, they are applied on the dimensions of the
<code>star_schema</code> object. Update operations must be defined with
the set of functions available for that purpose. Example:</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modify_dimension_records.html">modify_dimension_records</a></span><span class="op">(</span><span class="va">updates_st_mrs_age</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="constellation-1">Constellation<a class="anchor" aria-label="anchor" href="#constellation-1"></a>
</h4>
<ul>
<li>
<code><a href="../reference/modify_conformed_dimension_records.html">modify_conformed_dimension_records()</a></code>: Given a list of
dimension record update operations, they are applied on the conformed
dimensions of the <code>constellation</code> object. Update operations
must be defined with the set of functions available for that purpose.
Example:</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ct</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/modify_conformed_dimension_records.html">modify_conformed_dimension_records</a></span><span class="op">(</span><span class="va">updates_st_mrs_age</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="dimension-enrichment">Dimension enrichment<a class="anchor" aria-label="anchor" href="#dimension-enrichment"></a>
</h2>
<p>To enrich a dimension with new attributes related to others already
included in it, first, we export the attributes on which the new ones
depend, then we define the new attributes, and import the table with all
the attributes to be added to the dimension.</p>
<ul>
<li>
<code><a href="../reference/enrich_dimension_export.html">enrich_dimension_export()</a></code>: Export the selected
attributes of a dimension, without repeated combinations, to enrich the
dimension. If it is a role dimension they cannot be exported, you have
to work with the associated role playing dimension. Example:</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/enrich_dimension_export.html">enrich_dimension_export</a></span><span class="op">(</span><span class="va">st_mrs_age</span>,</span>
<span>                          name <span class="op">=</span> <span class="st">"when_common"</span>,</span>
<span>                          attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"week"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/enrich_dimension_import.html">enrich_dimension_import()</a></code>: For a dimension of a star
schema a <code>tibble</code> is attached. This contains dimension
attributes and new attributes. If values associated with all rows in the
dimension are included in the <code>tibble</code>, the dimension is
enriched with the new attributes. Role dimensions cannot be directly
enriched. If a role playing dimension is enriched, the new attributes
are also added to the associated role dimensions. Example:</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/enrich_dimension_export.html">enrich_dimension_export</a></span><span class="op">(</span><span class="va">st_mrs_age</span>,</span>
<span>                          name <span class="op">=</span> <span class="st">"when_common"</span>,</span>
<span>                          attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"week"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add new columns with meaningful data (these are not), possibly exporting</span></span>
<span><span class="co"># data to a file, populating it and importing it.</span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span><span class="va">tb</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>, z <span class="op">=</span> <span class="st">"z"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/enrich_dimension_import.html">enrich_dimension_import</a></span><span class="op">(</span><span class="va">st_mrs_age</span>, name <span class="op">=</span> <span class="st">"when_common"</span>, <span class="va">tb</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/enrich_dimension_import_test.html">enrich_dimension_import_test()</a></code>: Previous to
<code>enrich_dimension_import</code>, it checks if the
<code>tibble</code> has values for all dimension instances. Returns the
dimension instances that do not match the imported data. Example:</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/enrich_dimension_export.html">enrich_dimension_export</a></span><span class="op">(</span><span class="va">st_mrs_age</span>,</span>
<span>                          name <span class="op">=</span> <span class="st">"when_common"</span>,</span>
<span>                          attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"week"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add new columns with meaningful data (these are not), possibly exporting</span></span>
<span><span class="co"># data to a file, populating it and importing it.</span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span><span class="va">tb</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>, z <span class="op">=</span> <span class="st">"z"</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">tb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/enrich_dimension_import_test.html">enrich_dimension_import_test</a></span><span class="op">(</span><span class="va">st_mrs_age</span>, name <span class="op">=</span> <span class="st">"when_common"</span>, <span class="va">tb</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="incremental-refresh">Incremental refresh<a class="anchor" aria-label="anchor" href="#incremental-refresh"></a>
</h2>
<p>When new data is obtained, an incremental refresh of the data can be
carried out, both of the dimensions and of the facts. Incremental
refresh can be applied to both star schema and fact constellation, using
the following functions.</p>
<div class="section level4">
<h4 id="star-schema-2">Star schema<a class="anchor" aria-label="anchor" href="#star-schema-2"></a>
</h4>
<ul>
<li>
<code><a href="../reference/incremental_refresh_star_schema.html">incremental_refresh_star_schema()</a></code>: Incrementally
refresh a star schema with the content of a new one that is integrated
into the first. Once the dimensions are integrated, if there are records
in the fact table whose keys match the new ones, new ones can be
ignored, they can be replaced by new ones, all of them can be grouped
using the aggregation functions, or they can be deleted. Therefore, the
possible values of the <code>existing</code> parameter are: “ignore”,
“replace”, “group” or “delete”. Example:</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/incremental_refresh_star_schema.html">incremental_refresh_star_schema</a></span><span class="op">(</span><span class="va">st_mrs_age_w10</span>, existing <span class="op">=</span> <span class="st">"replace"</span><span class="op">)</span></span></code></pre></div>
<p>Sometimes the data refresh consists of eliminating data that is no
longer necessary, generally because it corresponds to a period that has
stopped being analysed but it can also be for other reasons. This data
can be selected using the following function:</p>
<ul>
<li>
<code><a href="../reference/filter_fact_rows.html">filter_fact_rows()</a></code>: Filter fact rows based on dimension
conditions in a star schema. Dimensions remain unchanged. Filtered rows
can be deleted using the <code>incremental_refresh_star_schema</code>
function. Example:</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_fact_rows.html">filter_fact_rows</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"when"</span>, <span class="va">when_happened_week</span> <span class="op">&lt;=</span> <span class="st">"03"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_fact_rows.html">filter_fact_rows</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"where"</span>, <span class="va">city</span> <span class="op">==</span> <span class="st">"Bridgeport"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">st2</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/incremental_refresh_star_schema.html">incremental_refresh_star_schema</a></span><span class="op">(</span><span class="va">st</span>, existing <span class="op">=</span> <span class="st">"delete"</span><span class="op">)</span></span></code></pre></div>
<p>Once the fact data is removed (using the other incremental refresh
functions), we can remove the data for the dimensions that are no longer
needed using the following function:</p>
<ul>
<li>
<code><a href="../reference/purge_dimensions_star_schema.html">purge_dimensions_star_schema()</a></code>: Delete instances of
dimensions not related to facts in a star schema. Example:</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st3</span> <span class="op">&lt;-</span> <span class="va">st2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/purge_dimensions_star_schema.html">purge_dimensions_star_schema</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="constellation-2">Constellation<a class="anchor" aria-label="anchor" href="#constellation-2"></a>
</h4>
<ul>
<li>
<code><a href="../reference/incremental_refresh_constellation.html">incremental_refresh_constellation()</a></code>: Incrementally
refresh a star schema in a constellation with the content of a new star
schema that is integrated into the first. Example:</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ct</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/incremental_refresh_constellation.html">incremental_refresh_constellation</a></span><span class="op">(</span><span class="va">st_mrs_age_w10</span>, existing <span class="op">=</span> <span class="st">"replace"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/purge_dimensions_constellation.html">purge_dimensions_constellation()</a></code>: Delete instances of
dimensions not related to facts in a star schema. It performs the
operation for each of the component <code>star_schemas</code> and also
for the conformed dimensions. Example:</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ct</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/purge_dimensions_constellation.html">purge_dimensions_constellation</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="exporting-results">Exporting results<a class="anchor" aria-label="anchor" href="#exporting-results"></a>
</h2>
<p>Once the data has been properly structured and transformed, it can be
exported to be consulted with other tools or with R. Various export
formats have been defined, both for star schemas and for constellations,
using the following functions.</p>
<div class="section level3">
<h3 id="star-schema-3">Star schema<a class="anchor" aria-label="anchor" href="#star-schema-3"></a>
</h3>
<ul>
<li>
<code><a href="../reference/star_schema_as_flat_table.html">star_schema_as_flat_table()</a></code>: We can again obtain a flat
table, implemented using a <code>tibble</code>, from a star schema.
Example:</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ft</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/star_schema_as_flat_table.html">star_schema_as_flat_table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/star_schema_as_multistar.html">star_schema_as_multistar()</a></code>: We can obtain a
<code>multistar</code>. A <code>multistar</code> only distinguishes
between general and conformed dimensions, each dimension has its own
data. It can contain multiple fact tables. Example:</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/star_schema_as_multistar.html">star_schema_as_multistar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/star_schema_as_tibble_list.html">star_schema_as_tibble_list()</a></code>: We can obtain a
<code>tibble</code> list with them. Role playing dimensions can be
optionally included. Example:</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tl</span> <span class="op">&lt;-</span> <span class="va">st_mrs_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/star_schema_as_tibble_list.html">star_schema_as_tibble_list</a></span><span class="op">(</span>include_role_playing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="constellation-3">Constellation<a class="anchor" aria-label="anchor" href="#constellation-3"></a>
</h3>
<ul>
<li>
<code><a href="../reference/constellation_as_multistar.html">constellation_as_multistar()</a></code>: We can obtain a
<code>multistar</code>. A <code>multistar</code> only distinguishes
between general and conformed dimensions, each dimension has its own
data. It can contain multiple fact tables. Example:</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/constellation_as_multistar.html">constellation_as_multistar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/constellation_as_tibble_list.html">constellation_as_tibble_list()</a></code>: We can obtain a
<code>tibble</code> list with them. Role playing dimensions can be
optionally included. Example:</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tl</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/constellation_as_tibble_list.html">constellation_as_tibble_list</a></span><span class="op">(</span>include_role_playing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multistar">
<code>multistar</code><a class="anchor" aria-label="anchor" href="#multistar"></a>
</h3>
<ul>
<li>
<code><a href="../reference/multistar_as_flat_table.html">multistar_as_flat_table()</a></code>: We can obtain a flat table,
implemented using a <code>tibble</code>, from a <code>multistar</code>
(which can be the result of a query). If it only has one fact table, it
is not necessary to provide its name. Example:</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ft</span> <span class="op">&lt;-</span> <span class="va">ms_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/multistar_as_flat_table.html">multistar_as_flat_table</a></span><span class="op">(</span>fact <span class="op">=</span> <span class="st">"mrs_age"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="query-functions">Query functions<a class="anchor" aria-label="anchor" href="#query-functions"></a>
</h2>
<p>There are many multidimensional query tools available. The exported
data, once stored in files, can be used directly from them. You can also
perform basic queries from R on data in the <code>multistar</code>
format, mainly for selecting the data to export, using the following
functions:</p>
<ul>
<li>
<code><a href="../reference/dimensional_query.html">dimensional_query()</a></code>: An empty
<code>dimensional_query</code> object is created where you can select
fact measures, dimension attributes and filter dimension rows.
Example:</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms_mrs</span> <span class="op">&lt;-</span> <span class="va">ct_mrs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/constellation_as_multistar.html">constellation_as_multistar</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_query.html">dimensional_query</a></span><span class="op">(</span><span class="va">ms_mrs</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/select_fact.html">select_fact()</a></code>: To define the fact to be consulted, its
name is indicated, optionally, a vector of names of selected measures
and another of aggregation functions are also indicated. If the name of
any measure is not indicated, only the one corresponding to the number
of aggregated rows is included, which is always included. If no
aggregation function is included, those defined for the measures are
considered. Examples:</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_query.html">dimensional_query</a></span><span class="op">(</span><span class="va">ms_mrs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_fact.html">select_fact</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"mrs_age"</span>,</span>
<span>    measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_deaths"</span><span class="op">)</span>,</span>
<span>    agg_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MAX"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">dq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_query.html">dimensional_query</a></span><span class="op">(</span><span class="va">ms_mrs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_fact.html">select_fact</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"mrs_age"</span>,</span>
<span>              measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_deaths"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_query.html">dimensional_query</a></span><span class="op">(</span><span class="va">ms_mrs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_fact.html">select_fact</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"mrs_age"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/select_dimension.html">select_dimension()</a></code>: To add a dimension in a
<code>dimensional_query</code> object, we have to define its name and a
subset of the dimension attributes. If only the name of the dimension is
indicated, it is considered that all its attributes should be added.
Example:</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_query.html">dimensional_query</a></span><span class="op">(</span><span class="va">ms_mrs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_dimension.html">select_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"where"</span>,</span>
<span>                   attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"city"</span>, <span class="st">"state"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_dimension.html">select_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"when"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/filter_dimension.html">filter_dimension()</a></code>: Allows you to define selection
conditions for dimension rows. Conditions can be defined on any
attribute of the dimension (not only on attributes selected in the query
for the dimension). The selection is made based on the function
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter</a></code>. Conditions are defined in exactly the same
way as in that function. Example:</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_query.html">dimensional_query</a></span><span class="op">(</span><span class="va">ms_mrs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_dimension.html">filter_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"when"</span>, <span class="va">when_happened_week</span> <span class="op">&lt;=</span> <span class="st">"03"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_dimension.html">filter_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"where"</span>, <span class="va">city</span> <span class="op">==</span> <span class="st">"Boston"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="../reference/run_query.html">run_query()</a></code>: Once we have selected the facts,
dimensions and defined the conditions on the instances, we can execute
the query to obtain the result. As an option, we can indicate if we do
not want to unify the facts in the case of having the same grain.
Example:</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimensional_query.html">dimensional_query</a></span><span class="op">(</span><span class="va">ms_mrs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_dimension.html">select_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"where"</span>,</span>
<span>                   attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"city"</span>, <span class="st">"state"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_dimension.html">select_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"when"</span>,</span>
<span>                   attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"when_happened_year"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_fact.html">select_fact</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"mrs_age"</span>,</span>
<span>    measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_deaths"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_fact.html">select_fact</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"mrs_cause"</span>,</span>
<span>    measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pneumonia_and_influenza_deaths"</span>, <span class="st">"other_deaths"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_dimension.html">filter_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"when"</span>, <span class="va">when_happened_week</span> <span class="op">&lt;=</span> <span class="st">"03"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_dimension.html">filter_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"where"</span>, <span class="va">city</span> <span class="op">==</span> <span class="st">"Boston"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/run_query.html">run_query</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p><code>starschemar</code> package offers a set of operations that
allow us to transform flat tables into star schemas. Star schemas
support the definition of role playing and role dimensions. Additional
transformation operations can be applied to each star schema to adapt
the format of the data. From several star schemas you can define fact
constellation with conformed dimensions.</p>
<p>Operations have been designed to be intuitive and easy to use. The
result greatly facilitates the data transformation process for the
exposed situation. In this document the available operations have been
briefly presented.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jose Samos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
